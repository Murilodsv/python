#if !defined(UM_JULES)
! *****************************COPYRIGHT*******************************
! (C) Crown copyright Met Office. All rights reserved.
! For further details please refer to the file COPYRIGHT.txt
! which you should have received as part of this distribution.
! *****************************COPYRIGHT*******************************

!  Saturation Specific Humidity Scheme (Qsat_Wat): Vapour to Liquid.
! Subroutine Interface:
SUBROUTINE qsat_wat (                                                         &
!      Output field
  qs                                                                          &
!      Input fields
, t, p                                                                        &
!      Array dimensions
, npnts                                                                       &
  )

!  Global Variables:----------------------------------------------------
USE planet_constants_mod, ONLY: one_minus_epsilon, repsilon 
USE conversions_mod, ONLY: zerodegc

IMPLICIT NONE

! Purpose:
!   RETURNS A SATURATION MIXING RATIO GIVEN A TEMPERATURE AND PRESSURE
!   USING SATURATION VAPOUR PRESSURES CALCULATED USING THE GOFF-GRATCH
!   FORMULAE, ADOPTED BY THE WMO AS TAKEN FROM LANDOLT-BORNSTEIN, 1987
!   NUMERICAL DATA AND FUNCTIONAL RELATIONSHIPS IN SCIENCE AND
!   TECHNOLOGY. GROUP V/VOL 4B METEOROLOGY. PHYSICAL AND CHEMICAL
!   PROPERTIES OF AIR, P35

!   VALUES IN THE LOOKUP TABLE ARE OVER WATER ABOVE AND BELOW 0 DEG C.

!   NOTE : FOR VAPOUR PRESSURE OVER WATER THIS FORMULA IS VALID FOR
!   TEMPERATURES BETWEEN 373K AND 223K.  THE VALUES FOR SATURATED VAPOUR
!   OVER WATER IN THE LOOKUP TABLE BELOW ARE OUT OF THE LOWER END OF
!   THIS RANGE.  HOWEVER IT IS STANDARD WMO PRACTICE TO USE THE FORMULA
!   BELOW ITS ACCEPTED RANGE FOR USE WITH THE CALCULATION OF DEW POINTS
!   IN THE UPPER ATMOSPHERE

! Method:
!   Uses lookup tables to find eSAT, calculates qSAT directly from that.

! Code Owner: Please refer to ModuleLeaders.txt and UM file CodeOwners.txt

! History:
!   Version  Date    Comment
!    5.1   14-03-00  Correct 2B (optimized) version for use in UM5.x .
!                                                        A.C.Bushell
!    6.2   03-02-06  Moved to A71_1A.  P.Selwood

! Code Description:
!   Language: FORTRAN 77  + common extensions also in Fortran90.
!   This code is written to UMDP3 version 6 programming standards.

!   Documentation: UMDP No.29

! Declarations:



!  Subroutine Arguments:------------------------------------------------

! arguments with intent in. ie: input variables.

INTEGER ::                                                                    &
                  !, INTENT(IN)
  npnts
!       Points (=horizontal dimensions) being processed by qSAT scheme.

REAL ::                                                                       &
                  !, INTENT(IN)
  t(npnts)                                                                    &
!       Temperature (K).
, p(npnts)
!       Pressure (Pa).

! arguments with intent out. ie: output variables.

REAL ::                                                                       &
                  !, INTENT(OUT)
  qs(npnts)
!       SATURATION MIXING RATIO AT TEMPERATURE T AND PRESSURE P (KG/KG)

!  Local parameters and other physical constants------------------------
REAL :: t_low        ! LOWEST TEMPERATURE FOR WHICH LOOK-UP TABLE OF
!                         SATURATION WATER VAPOUR PRESSURE IS VALID (K)

REAL :: t_high       ! HIGHEST TEMPERATURE FOR WHICH LOOK-UP TABLE OF
!                         SATURATION WATER VAPOUR PRESSURE IS VALID (K)

REAL :: delta_t      ! TEMPERATURE INCREMENT OF THE LOOK-UP
                  ! TABLE OF SATURATION VAPOUR PRESSURES

INTEGER :: n         ! SIZE OF LOOK-UP TABLE OF SATURATION
                  ! WATER VAPOUR PRESSURES

PARAMETER ( t_low = 183.15,                                                   &
            t_high = 338.15,                                                  &
            delta_t = 0.1,                                                    &
            n = ((t_high - t_low + (delta_t * 0.5)) / delta_t) + 1.0          &
          )    ! gives N=1551

!  Local scalars--------------------------------------------------------

!  (a) Scalars effectively expanded to workspace by the Cray (using
!      vector registers).

INTEGER :: itable    ! WORK VARIABLES

REAL :: atable       ! WORK VARIABLES

!     VARIABLES INTRODUCED BY DLR.

REAL :: fsubw        ! FACTOR THAT CONVERTS FROM SAT VAPOUR PRESSURE
!                         IN A PURE WATER SYSTEM TO SAT VAPOUR PRESSURE
!                         IN AIR.
REAL :: tt

!  (b) Others.
INTEGER :: i         ! LOOP COUNTERS

INTEGER :: ies       ! LOOP COUNTER FOR DATA STATEMENT LOOK-UP TABLE

!  Local dynamic arrays-------------------------------------------------
REAL :: es(0:n+1)    ! TABLE OF SATURATION WATER VAPOUR PRESSURE (PA)
!                       - SET BY DATA STATEMENT CALCULATED FROM THE
!                         GOFF-GRATCH FORMULAE AS TAKEN FROM LANDOLT-
!                         BORNSTEIN, 1987 NUMERICAL DATA AND FUNCTIONAL
!                         RELATIONSHIPS IN SCIENCE AND TECHNOLOGY.
!                         GROUP V/ VOL 4B METEOROLOGY. PHYSICAL AND
!                         CHEMICAL PROPERTIES OF AIR, P35

!  External subroutine calls: ------------------------------------------
!     EXTERNAL None
!- End of Header

! ==Main Block==--------------------------------------------------------
! Subroutine structure :
! NO SIGNIFICANT STRUCTURE
! ----------------------------------------------------------------------
! SATURATION WATER VAPOUR PRESSURE

! VALUES ABOVE AND BELOW 0 DEG C ARE OVER WATER

! VALUES BELOW -50 DEC C ARE OUTSIDE FORMAL RANGE OF WMO ADOPTED FORMULA
! (SEE ABOVE).  HOWEVER STANDARD PRACTICE TO USE THESE VALUES
! ----------------------------------------------------------------------
! Note: 0 element is a repeat of 1st element to cater for special case
!       of low temperatures ( <= T_LOW) for which the array index is
!       rounded down due to machine precision.
DATA (es(ies),ies=    0, 95) / 0.186905e-01,                                  &
0.186905e-01,0.190449e-01,0.194059e-01,0.197727e-01,0.201462e-01,             &
0.205261e-01,0.209122e-01,0.213052e-01,0.217050e-01,0.221116e-01,             &
0.225252e-01,0.229463e-01,0.233740e-01,0.238090e-01,0.242518e-01,             &
0.247017e-01,0.251595e-01,0.256252e-01,0.260981e-01,0.265795e-01,             &
0.270691e-01,0.275667e-01,0.280733e-01,0.285876e-01,0.291105e-01,             &
0.296429e-01,0.301835e-01,0.307336e-01,0.312927e-01,0.318611e-01,             &
0.324390e-01,0.330262e-01,0.336232e-01,0.342306e-01,0.348472e-01,             &
0.354748e-01,0.361117e-01,0.367599e-01,0.374185e-01,0.380879e-01,             &
0.387689e-01,0.394602e-01,0.401626e-01,0.408771e-01,0.416033e-01,             &
0.423411e-01,0.430908e-01,0.438524e-01,0.446263e-01,0.454124e-01,             &
0.462122e-01,0.470247e-01,0.478491e-01,0.486874e-01,0.495393e-01,             &
0.504057e-01,0.512847e-01,0.521784e-01,0.530853e-01,0.540076e-01,             &
0.549444e-01,0.558959e-01,0.568633e-01,0.578448e-01,0.588428e-01,             &
0.598566e-01,0.608858e-01,0.619313e-01,0.629926e-01,0.640706e-01,             &
0.651665e-01,0.662795e-01,0.674095e-01,0.685570e-01,0.697219e-01,             &
0.709063e-01,0.721076e-01,0.733284e-01,0.745679e-01,0.758265e-01,             &
0.771039e-01,0.784026e-01,0.797212e-01,0.810577e-01,0.824164e-01,             &
0.837971e-01,0.851970e-01,0.866198e-01,0.880620e-01,0.895281e-01,             &
0.910178e-01,0.925278e-01,0.940622e-01,0.956177e-01,0.971984e-01 /
DATA (es(ies),ies= 96,190) /                                                  &
0.988051e-01,0.100433e00,0.102085e00,0.103764e00,0.105467e00,                 &
0.107196e00,0.108953e00,0.110732e00,0.112541e00,0.114376e00,                  &
0.116238e00,0.118130e00,0.120046e00,0.121993e00,0.123969e00,                  &
0.125973e00,0.128009e00,0.130075e00,0.132167e00,0.134296e00,                  &
0.136452e00,0.138642e00,0.140861e00,0.143115e00,0.145404e00,                  &
0.147723e00,0.150078e00,0.152466e00,0.154889e00,0.157346e00,                  &
0.159841e00,0.162372e00,0.164939e00,0.167545e00,0.170185e00,                  &
0.172866e00,0.175584e00,0.178340e00,0.181139e00,0.183977e00,                  &
0.186855e00,0.189773e00,0.192737e00,0.195736e00,0.198783e00,                  &
0.201875e00,0.205007e00,0.208186e00,0.211409e00,0.214676e00,                  &
0.217993e00,0.221355e00,0.224764e00,0.228220e00,0.231728e00,                  &
0.235284e00,0.238888e00,0.242542e00,0.246251e00,0.250010e00,                  &
0.253821e00,0.257688e00,0.261602e00,0.265575e00,0.269607e00,                  &
0.273689e00,0.277830e00,0.282027e00,0.286287e00,0.290598e00,                  &
0.294972e00,0.299405e00,0.303904e00,0.308462e00,0.313082e00,                  &
0.317763e00,0.322512e00,0.327324e00,0.332201e00,0.337141e00,                  &
0.342154e00,0.347234e00,0.352387e00,0.357601e00,0.362889e00,                  &
0.368257e00,0.373685e00,0.379194e00,0.384773e00,0.390433e00,                  &
0.396159e00,0.401968e00,0.407861e00,0.413820e00,0.419866e00 /
DATA (es(ies),ies = 191,285) /                                                &
0.425999e00,0.432203e00,0.438494e00,0.444867e00,0.451332e00,                  &
0.457879e00,0.464510e00,0.471226e00,0.478037e00,0.484935e00,                  &
0.491920e00,0.499005e00,0.506181e00,0.513447e00,0.520816e00,                  &
0.528279e00,0.535835e00,0.543497e00,0.551256e00,0.559113e00,                  &
0.567081e00,0.575147e00,0.583315e00,0.591585e00,0.599970e00,                  &
0.608472e00,0.617069e00,0.625785e00,0.634609e00,0.643556e00,                  &
0.652611e00,0.661782e00,0.671077e00,0.680487e00,0.690015e00,                  &
0.699656e00,0.709433e00,0.719344e00,0.729363e00,0.739518e00,                  &
0.749795e00,0.760217e00,0.770763e00,0.781454e00,0.792258e00,                  &
0.803208e00,0.814309e00,0.825528e00,0.836914e00,0.848422e00,                  &
0.860086e00,0.871891e00,0.883837e00,0.895944e00,0.908214e00,                  &
0.920611e00,0.933175e00,0.945890e00,0.958776e00,0.971812e00,                  &
0.985027e00,0.998379e00,0.101193e01,0.102561e01,0.103949e01,                  &
0.105352e01,0.106774e01,0.108213e01,0.109669e01,0.111144e01,                  &
0.112636e01,0.114148e01,0.115676e01,0.117226e01,0.118791e01,                  &
0.120377e01,0.121984e01,0.123608e01,0.125252e01,0.126919e01,                  &
0.128604e01,0.130309e01,0.132036e01,0.133782e01,0.135549e01,                  &
0.137339e01,0.139150e01,0.140984e01,0.142839e01,0.144715e01,                  &
0.146616e01,0.148538e01,0.150482e01,0.152450e01,0.154445e01 /
DATA (es(ies),ies = 286,380) /                                                &
0.156459e01,0.158502e01,0.160564e01,0.162654e01,0.164766e01,                  &
0.166906e01,0.169070e01,0.171257e01,0.173473e01,0.175718e01,                  &
0.177984e01,0.180282e01,0.182602e01,0.184951e01,0.187327e01,                  &
0.189733e01,0.192165e01,0.194629e01,0.197118e01,0.199636e01,                  &
0.202185e01,0.204762e01,0.207372e01,0.210010e01,0.212678e01,                  &
0.215379e01,0.218109e01,0.220873e01,0.223668e01,0.226497e01,                  &
0.229357e01,0.232249e01,0.235176e01,0.238134e01,0.241129e01,                  &
0.244157e01,0.247217e01,0.250316e01,0.253447e01,0.256617e01,                  &
0.259821e01,0.263064e01,0.266341e01,0.269661e01,0.273009e01,                  &
0.276403e01,0.279834e01,0.283302e01,0.286811e01,0.290358e01,                  &
0.293943e01,0.297571e01,0.301236e01,0.304946e01,0.308702e01,                  &
0.312491e01,0.316326e01,0.320208e01,0.324130e01,0.328092e01,                  &
0.332102e01,0.336162e01,0.340264e01,0.344407e01,0.348601e01,                  &
0.352838e01,0.357118e01,0.361449e01,0.365834e01,0.370264e01,                  &
0.374737e01,0.379265e01,0.383839e01,0.388469e01,0.393144e01,                  &
0.397876e01,0.402656e01,0.407492e01,0.412378e01,0.417313e01,                  &
0.422306e01,0.427359e01,0.432454e01,0.437617e01,0.442834e01,                  &
0.448102e01,0.453433e01,0.458816e01,0.464253e01,0.469764e01,                  &
0.475321e01,0.480942e01,0.486629e01,0.492372e01,0.498173e01 /
DATA (es(ies),ies = 381,475) /                                                &
0.504041e01,0.509967e01,0.515962e01,0.522029e01,0.528142e01,                  &
0.534337e01,0.540595e01,0.546912e01,0.553292e01,0.559757e01,                  &
0.566273e01,0.572864e01,0.579532e01,0.586266e01,0.593075e01,                  &
0.599952e01,0.606895e01,0.613918e01,0.621021e01,0.628191e01,                  &
0.635433e01,0.642755e01,0.650162e01,0.657639e01,0.665188e01,                  &
0.672823e01,0.680532e01,0.688329e01,0.696198e01,0.704157e01,                  &
0.712206e01,0.720319e01,0.728534e01,0.736829e01,0.745204e01,                  &
0.753671e01,0.762218e01,0.770860e01,0.779588e01,0.788408e01,                  &
0.797314e01,0.806318e01,0.815408e01,0.824599e01,0.833874e01,                  &
0.843254e01,0.852721e01,0.862293e01,0.871954e01,0.881724e01,                  &
0.891579e01,0.901547e01,0.911624e01,0.921778e01,0.932061e01,                  &
0.942438e01,0.952910e01,0.963497e01,0.974181e01,0.984982e01,                  &
0.995887e01,0.100690e02,0.101804e02,0.102926e02,0.104063e02,                  &
0.105210e02,0.106367e02,0.107536e02,0.108719e02,0.109912e02,                  &
0.111116e02,0.112333e02,0.113563e02,0.114804e02,0.116056e02,                  &
0.117325e02,0.118602e02,0.119892e02,0.121197e02,0.122513e02,                  &
0.123844e02,0.125186e02,0.126543e02,0.127912e02,0.129295e02,                  &
0.130691e02,0.132101e02,0.133527e02,0.134965e02,0.136415e02,                  &
0.137882e02,0.139361e02,0.140855e02,0.142366e02,0.143889e02 /
DATA (es(ies),ies = 476,570) /                                                &
0.145429e02,0.146982e02,0.148552e02,0.150135e02,0.151735e02,                  &
0.153349e02,0.154979e02,0.156624e02,0.158286e02,0.159965e02,                  &
0.161659e02,0.163367e02,0.165094e02,0.166838e02,0.168597e02,                  &
0.170375e02,0.172168e02,0.173979e02,0.175806e02,0.177651e02,                  &
0.179513e02,0.181394e02,0.183293e02,0.185210e02,0.187146e02,                  &
0.189098e02,0.191066e02,0.193059e02,0.195065e02,0.197095e02,                  &
0.199142e02,0.201206e02,0.203291e02,0.205397e02,0.207522e02,                  &
0.209664e02,0.211831e02,0.214013e02,0.216221e02,0.218448e02,                  &
0.220692e02,0.222959e02,0.225250e02,0.227559e02,0.229887e02,                  &
0.232239e02,0.234614e02,0.237014e02,0.239428e02,0.241872e02,                  &
0.244335e02,0.246824e02,0.249332e02,0.251860e02,0.254419e02,                  &
0.256993e02,0.259600e02,0.262225e02,0.264873e02,0.267552e02,                  &
0.270248e02,0.272970e02,0.275719e02,0.278497e02,0.281295e02,                  &
0.284117e02,0.286965e02,0.289843e02,0.292743e02,0.295671e02,                  &
0.298624e02,0.301605e02,0.304616e02,0.307650e02,0.310708e02,                  &
0.313803e02,0.316915e02,0.320064e02,0.323238e02,0.326437e02,                  &
0.329666e02,0.332928e02,0.336215e02,0.339534e02,0.342885e02,                  &
0.346263e02,0.349666e02,0.353109e02,0.356572e02,0.360076e02,                  &
0.363606e02,0.367164e02,0.370757e02,0.374383e02,0.378038e02 /
DATA (es(ies),ies = 571,665) /                                                &
0.381727e02,0.385453e02,0.389206e02,0.392989e02,0.396807e02,                  &
0.400663e02,0.404555e02,0.408478e02,0.412428e02,0.416417e02,                  &
0.420445e02,0.424502e02,0.428600e02,0.432733e02,0.436900e02,                  &
0.441106e02,0.445343e02,0.449620e02,0.453930e02,0.458280e02,                  &
0.462672e02,0.467096e02,0.471561e02,0.476070e02,0.480610e02,                  &
0.485186e02,0.489813e02,0.494474e02,0.499170e02,0.503909e02,                  &
0.508693e02,0.513511e02,0.518376e02,0.523277e02,0.528232e02,                  &
0.533213e02,0.538240e02,0.543315e02,0.548437e02,0.553596e02,                  &
0.558802e02,0.564046e02,0.569340e02,0.574672e02,0.580061e02,                  &
0.585481e02,0.590963e02,0.596482e02,0.602041e02,0.607649e02,                  &
0.613311e02,0.619025e02,0.624779e02,0.630574e02,0.636422e02,                  &
0.642324e02,0.648280e02,0.654278e02,0.660332e02,0.666426e02,                  &
0.672577e02,0.678771e02,0.685034e02,0.691328e02,0.697694e02,                  &
0.704103e02,0.710556e02,0.717081e02,0.723639e02,0.730269e02,                  &
0.736945e02,0.743681e02,0.750463e02,0.757309e02,0.764214e02,                  &
0.771167e02,0.778182e02,0.785246e02,0.792373e02,0.799564e02,                  &
0.806804e02,0.814109e02,0.821479e02,0.828898e02,0.836384e02,                  &
0.843922e02,0.851525e02,0.859198e02,0.866920e02,0.874712e02,                  &
0.882574e02,0.890486e02,0.898470e02,0.906525e02,0.914634e02 /
DATA (es(ies),ies = 666,760) /                                                &
0.922814e02,0.931048e02,0.939356e02,0.947736e02,0.956171e02,                  &
0.964681e02,0.973246e02,0.981907e02,0.990605e02,0.999399e02,                  &
0.100825e03,0.101718e03,0.102617e03,0.103523e03,0.104438e03,                  &
0.105358e03,0.106287e03,0.107221e03,0.108166e03,0.109115e03,                  &
0.110074e03,0.111039e03,0.112012e03,0.112992e03,0.113981e03,                  &
0.114978e03,0.115981e03,0.116993e03,0.118013e03,0.119041e03,                  &
0.120077e03,0.121122e03,0.122173e03,0.123234e03,0.124301e03,                  &
0.125377e03,0.126463e03,0.127556e03,0.128657e03,0.129769e03,                  &
0.130889e03,0.132017e03,0.133152e03,0.134299e03,0.135453e03,                  &
0.136614e03,0.137786e03,0.138967e03,0.140158e03,0.141356e03,                  &
0.142565e03,0.143781e03,0.145010e03,0.146247e03,0.147491e03,                  &
0.148746e03,0.150011e03,0.151284e03,0.152571e03,0.153862e03,                  &
0.155168e03,0.156481e03,0.157805e03,0.159137e03,0.160478e03,                  &
0.161832e03,0.163198e03,0.164569e03,0.165958e03,0.167348e03,                  &
0.168757e03,0.170174e03,0.171599e03,0.173037e03,0.174483e03,                  &
0.175944e03,0.177414e03,0.178892e03,0.180387e03,0.181886e03,                  &
0.183402e03,0.184930e03,0.186463e03,0.188012e03,0.189571e03,                  &
0.191146e03,0.192730e03,0.194320e03,0.195930e03,0.197546e03,                  &
0.199175e03,0.200821e03,0.202473e03,0.204142e03,0.205817e03 /
DATA (es(ies),ies = 761,855) /                                                &
0.207510e03,0.209216e03,0.210928e03,0.212658e03,0.214398e03,                  &
0.216152e03,0.217920e03,0.219698e03,0.221495e03,0.223297e03,                  &
0.225119e03,0.226951e03,0.228793e03,0.230654e03,0.232522e03,                  &
0.234413e03,0.236311e03,0.238223e03,0.240151e03,0.242090e03,                  &
0.244049e03,0.246019e03,0.248000e03,0.249996e03,0.252009e03,                  &
0.254037e03,0.256077e03,0.258128e03,0.260200e03,0.262284e03,                  &
0.264384e03,0.266500e03,0.268629e03,0.270779e03,0.272936e03,                  &
0.275110e03,0.277306e03,0.279509e03,0.281734e03,0.283966e03,                  &
0.286227e03,0.288494e03,0.290780e03,0.293083e03,0.295398e03,                  &
0.297737e03,0.300089e03,0.302453e03,0.304841e03,0.307237e03,                  &
0.309656e03,0.312095e03,0.314541e03,0.317012e03,0.319496e03,                  &
0.322005e03,0.324527e03,0.327063e03,0.329618e03,0.332193e03,                  &
0.334788e03,0.337396e03,0.340025e03,0.342673e03,0.345329e03,                  &
0.348019e03,0.350722e03,0.353440e03,0.356178e03,0.358938e03,                  &
0.361718e03,0.364513e03,0.367322e03,0.370160e03,0.373012e03,                  &
0.375885e03,0.378788e03,0.381691e03,0.384631e03,0.387579e03,                  &
0.390556e03,0.393556e03,0.396563e03,0.399601e03,0.402646e03,                  &
0.405730e03,0.408829e03,0.411944e03,0.415083e03,0.418236e03,                  &
0.421422e03,0.424632e03,0.427849e03,0.431099e03,0.434365e03 /
DATA (es(ies),ies = 856,950) /                                                &
0.437655e03,0.440970e03,0.444301e03,0.447666e03,0.451038e03,                  &
0.454445e03,0.457876e03,0.461316e03,0.464790e03,0.468281e03,                  &
0.471798e03,0.475342e03,0.478902e03,0.482497e03,0.486101e03,                  &
0.489741e03,0.493408e03,0.497083e03,0.500804e03,0.504524e03,                  &
0.508290e03,0.512074e03,0.515877e03,0.519717e03,0.523566e03,                  &
0.527462e03,0.531367e03,0.535301e03,0.539264e03,0.543245e03,                  &
0.547265e03,0.551305e03,0.555363e03,0.559462e03,0.563579e03,                  &
0.567727e03,0.571905e03,0.576102e03,0.580329e03,0.584576e03,                  &
0.588865e03,0.593185e03,0.597514e03,0.601885e03,0.606276e03,                  &
0.610699e03,0.615151e03,0.619625e03,0.624140e03,0.628671e03,                  &
0.633243e03,0.637845e03,0.642465e03,0.647126e03,0.651806e03,                  &
0.656527e03,0.661279e03,0.666049e03,0.670861e03,0.675692e03,                  &
0.680566e03,0.685471e03,0.690396e03,0.695363e03,0.700350e03,                  &
0.705381e03,0.710444e03,0.715527e03,0.720654e03,0.725801e03,                  &
0.730994e03,0.736219e03,0.741465e03,0.746756e03,0.752068e03,                  &
0.757426e03,0.762819e03,0.768231e03,0.773692e03,0.779172e03,                  &
0.784701e03,0.790265e03,0.795849e03,0.801483e03,0.807137e03,                  &
0.812842e03,0.818582e03,0.824343e03,0.830153e03,0.835987e03,                  &
0.841871e03,0.847791e03,0.853733e03,0.859727e03,0.865743e03 /
DATA (es(ies),ies = 951,1045) /                                               &
0.871812e03,0.877918e03,0.884046e03,0.890228e03,0.896433e03,                  &
0.902690e03,0.908987e03,0.915307e03,0.921681e03,0.928078e03,                  &
0.934531e03,0.941023e03,0.947539e03,0.954112e03,0.960708e03,                  &
0.967361e03,0.974053e03,0.980771e03,0.987545e03,0.994345e03,                  &
0.100120e04,0.100810e04,0.101502e04,0.102201e04,0.102902e04,                  &
0.103608e04,0.104320e04,0.105033e04,0.105753e04,0.106475e04,                  &
0.107204e04,0.107936e04,0.108672e04,0.109414e04,0.110158e04,                  &
0.110908e04,0.111663e04,0.112421e04,0.113185e04,0.113952e04,                  &
0.114725e04,0.115503e04,0.116284e04,0.117071e04,0.117861e04,                  &
0.118658e04,0.119459e04,0.120264e04,0.121074e04,0.121888e04,                  &
0.122709e04,0.123534e04,0.124362e04,0.125198e04,0.126036e04,                  &
0.126881e04,0.127731e04,0.128584e04,0.129444e04,0.130307e04,                  &
0.131177e04,0.132053e04,0.132931e04,0.133817e04,0.134705e04,                  &
0.135602e04,0.136503e04,0.137407e04,0.138319e04,0.139234e04,                  &
0.140156e04,0.141084e04,0.142015e04,0.142954e04,0.143896e04,                  &
0.144845e04,0.145800e04,0.146759e04,0.147725e04,0.148694e04,                  &
0.149672e04,0.150655e04,0.151641e04,0.152635e04,0.153633e04,                  &
0.154639e04,0.155650e04,0.156665e04,0.157688e04,0.158715e04,                  &
0.159750e04,0.160791e04,0.161836e04,0.162888e04,0.163945e04 /
DATA (es(ies),ies = 1046,1140) /                                              &
0.165010e04,0.166081e04,0.167155e04,0.168238e04,0.169325e04,                  &
0.170420e04,0.171522e04,0.172627e04,0.173741e04,0.174859e04,                  &
0.175986e04,0.177119e04,0.178256e04,0.179402e04,0.180552e04,                  &
0.181711e04,0.182877e04,0.184046e04,0.185224e04,0.186407e04,                  &
0.187599e04,0.188797e04,0.190000e04,0.191212e04,0.192428e04,                  &
0.193653e04,0.194886e04,0.196122e04,0.197368e04,0.198618e04,                  &
0.199878e04,0.201145e04,0.202416e04,0.203698e04,0.204983e04,                  &
0.206278e04,0.207580e04,0.208887e04,0.210204e04,0.211525e04,                  &
0.212856e04,0.214195e04,0.215538e04,0.216892e04,0.218249e04,                  &
0.219618e04,0.220994e04,0.222375e04,0.223766e04,0.225161e04,                  &
0.226567e04,0.227981e04,0.229399e04,0.230829e04,0.232263e04,                  &
0.233708e04,0.235161e04,0.236618e04,0.238087e04,0.239560e04,                  &
0.241044e04,0.242538e04,0.244035e04,0.245544e04,0.247057e04,                  &
0.248583e04,0.250116e04,0.251654e04,0.253204e04,0.254759e04,                  &
0.256325e04,0.257901e04,0.259480e04,0.261073e04,0.262670e04,                  &
0.264279e04,0.265896e04,0.267519e04,0.269154e04,0.270794e04,                  &
0.272447e04,0.274108e04,0.275774e04,0.277453e04,0.279137e04,                  &
0.280834e04,0.282540e04,0.284251e04,0.285975e04,0.287704e04,                  &
0.289446e04,0.291198e04,0.292954e04,0.294725e04,0.296499e04 /
DATA (es(ies),ies = 1141,1235) /                                              &
0.298288e04,0.300087e04,0.301890e04,0.303707e04,0.305529e04,                  &
0.307365e04,0.309211e04,0.311062e04,0.312927e04,0.314798e04,                  &
0.316682e04,0.318577e04,0.320477e04,0.322391e04,0.324310e04,                  &
0.326245e04,0.328189e04,0.330138e04,0.332103e04,0.334073e04,                  &
0.336058e04,0.338053e04,0.340054e04,0.342069e04,0.344090e04,                  &
0.346127e04,0.348174e04,0.350227e04,0.352295e04,0.354369e04,                  &
0.356458e04,0.358559e04,0.360664e04,0.362787e04,0.364914e04,                  &
0.367058e04,0.369212e04,0.371373e04,0.373548e04,0.375731e04,                  &
0.377929e04,0.380139e04,0.382355e04,0.384588e04,0.386826e04,                  &
0.389081e04,0.391348e04,0.393620e04,0.395910e04,0.398205e04,                  &
0.400518e04,0.402843e04,0.405173e04,0.407520e04,0.409875e04,                  &
0.412246e04,0.414630e04,0.417019e04,0.419427e04,0.421840e04,                  &
0.424272e04,0.426715e04,0.429165e04,0.431634e04,0.434108e04,                  &
0.436602e04,0.439107e04,0.441618e04,0.444149e04,0.446685e04,                  &
0.449241e04,0.451810e04,0.454385e04,0.456977e04,0.459578e04,                  &
0.462197e04,0.464830e04,0.467468e04,0.470127e04,0.472792e04,                  &
0.475477e04,0.478175e04,0.480880e04,0.483605e04,0.486336e04,                  &
0.489087e04,0.491853e04,0.494623e04,0.497415e04,0.500215e04,                  &
0.503034e04,0.505867e04,0.508707e04,0.511568e04,0.514436e04 /
DATA (es(ies),ies = 1236,1330) /                                              &
0.517325e04,0.520227e04,0.523137e04,0.526068e04,0.529005e04,                  &
0.531965e04,0.534939e04,0.537921e04,0.540923e04,0.543932e04,                  &
0.546965e04,0.550011e04,0.553064e04,0.556139e04,0.559223e04,                  &
0.562329e04,0.565449e04,0.568577e04,0.571727e04,0.574884e04,                  &
0.578064e04,0.581261e04,0.584464e04,0.587692e04,0.590924e04,                  &
0.594182e04,0.597455e04,0.600736e04,0.604039e04,0.607350e04,                  &
0.610685e04,0.614036e04,0.617394e04,0.620777e04,0.624169e04,                  &
0.627584e04,0.631014e04,0.634454e04,0.637918e04,0.641390e04,                  &
0.644887e04,0.648400e04,0.651919e04,0.655467e04,0.659021e04,                  &
0.662599e04,0.666197e04,0.669800e04,0.673429e04,0.677069e04,                  &
0.680735e04,0.684415e04,0.688104e04,0.691819e04,0.695543e04,                  &
0.699292e04,0.703061e04,0.706837e04,0.710639e04,0.714451e04,                  &
0.718289e04,0.722143e04,0.726009e04,0.729903e04,0.733802e04,                  &
0.737729e04,0.741676e04,0.745631e04,0.749612e04,0.753602e04,                  &
0.757622e04,0.761659e04,0.765705e04,0.769780e04,0.773863e04,                  &
0.777975e04,0.782106e04,0.786246e04,0.790412e04,0.794593e04,                  &
0.798802e04,0.803028e04,0.807259e04,0.811525e04,0.815798e04,                  &
0.820102e04,0.824427e04,0.828757e04,0.833120e04,0.837493e04,                  &
0.841895e04,0.846313e04,0.850744e04,0.855208e04,0.859678e04 /
DATA (es(ies),ies = 1331,1425) /                                              &
0.864179e04,0.868705e04,0.873237e04,0.877800e04,0.882374e04,                  &
0.886979e04,0.891603e04,0.896237e04,0.900904e04,0.905579e04,                  &
0.910288e04,0.915018e04,0.919758e04,0.924529e04,0.929310e04,                  &
0.934122e04,0.938959e04,0.943804e04,0.948687e04,0.953575e04,                  &
0.958494e04,0.963442e04,0.968395e04,0.973384e04,0.978383e04,                  &
0.983412e04,0.988468e04,0.993534e04,0.998630e04,0.100374e05,                  &
0.100888e05,0.101406e05,0.101923e05,0.102444e05,0.102966e05,                  &
0.103492e05,0.104020e05,0.104550e05,0.105082e05,0.105616e05,                  &
0.106153e05,0.106693e05,0.107234e05,0.107779e05,0.108325e05,                  &
0.108874e05,0.109425e05,0.109978e05,0.110535e05,0.111092e05,                  &
0.111653e05,0.112217e05,0.112782e05,0.113350e05,0.113920e05,                  &
0.114493e05,0.115070e05,0.115646e05,0.116228e05,0.116809e05,                  &
0.117396e05,0.117984e05,0.118574e05,0.119167e05,0.119762e05,                  &
0.120360e05,0.120962e05,0.121564e05,0.122170e05,0.122778e05,                  &
0.123389e05,0.124004e05,0.124619e05,0.125238e05,0.125859e05,                  &
0.126484e05,0.127111e05,0.127739e05,0.128372e05,0.129006e05,                  &
0.129644e05,0.130285e05,0.130927e05,0.131573e05,0.132220e05,                  &
0.132872e05,0.133526e05,0.134182e05,0.134842e05,0.135503e05,                  &
0.136168e05,0.136836e05,0.137505e05,0.138180e05,0.138854e05 /
DATA (es(ies),ies = 1426,1520) /                                              &
0.139534e05,0.140216e05,0.140900e05,0.141588e05,0.142277e05,                  &
0.142971e05,0.143668e05,0.144366e05,0.145069e05,0.145773e05,                  &
0.146481e05,0.147192e05,0.147905e05,0.148622e05,0.149341e05,                  &
0.150064e05,0.150790e05,0.151517e05,0.152250e05,0.152983e05,                  &
0.153721e05,0.154462e05,0.155205e05,0.155952e05,0.156701e05,                  &
0.157454e05,0.158211e05,0.158969e05,0.159732e05,0.160496e05,                  &
0.161265e05,0.162037e05,0.162811e05,0.163589e05,0.164369e05,                  &
0.165154e05,0.165942e05,0.166732e05,0.167526e05,0.168322e05,                  &
0.169123e05,0.169927e05,0.170733e05,0.171543e05,0.172356e05,                  &
0.173173e05,0.173993e05,0.174815e05,0.175643e05,0.176471e05,                  &
0.177305e05,0.178143e05,0.178981e05,0.179826e05,0.180671e05,                  &
0.181522e05,0.182377e05,0.183232e05,0.184093e05,0.184955e05,                  &
0.185823e05,0.186695e05,0.187568e05,0.188447e05,0.189326e05,                  &
0.190212e05,0.191101e05,0.191991e05,0.192887e05,0.193785e05,                  &
0.194688e05,0.195595e05,0.196503e05,0.197417e05,0.198332e05,                  &
0.199253e05,0.200178e05,0.201105e05,0.202036e05,0.202971e05,                  &
0.203910e05,0.204853e05,0.205798e05,0.206749e05,0.207701e05,                  &
0.208659e05,0.209621e05,0.210584e05,0.211554e05,0.212524e05,                  &
0.213501e05,0.214482e05,0.215465e05,0.216452e05,0.217442e05 /
DATA (es(ies),ies = 1521,1552) /                                              &
0.218439e05,0.219439e05,0.220440e05,0.221449e05,0.222457e05,                  &
0.223473e05,0.224494e05,0.225514e05,0.226542e05,0.227571e05,                  &
0.228606e05,0.229646e05,0.230687e05,0.231734e05,0.232783e05,                  &
0.233839e05,0.234898e05,0.235960e05,0.237027e05,0.238097e05,                  &
0.239173e05,0.240254e05,0.241335e05,0.242424e05,0.243514e05,                  &
0.244611e05,0.245712e05,0.246814e05,0.247923e05,0.249034e05,                  &
0.250152e05,0.250152e05 /

! Npnts_do_1:
DO i = 1,npnts
  !      COMPUTE THE FACTOR THAT CONVERTS FROM SAT VAPOUR PRESSURE IN A
  !      PURE WATER SYSTEM TO SAT VAPOUR PRESSURE IN AIR, FSUBW.
  !      THIS FORMULA IS TAKEN FROM EQUATION A4.7 OF ADRIAN GILL'S BOOK:
  !      ATMOSPHERE-OCEAN DYNAMICS. NOTE THAT HIS FORMULA WORKS IN TERMS
  !      OF PRESSURE IN MB AND TEMPERATURE IN CELSIUS, SO CONVERSION OF
  !      UNITS LEADS TO THE SLIGHTLY DIFFERENT EQUATION USED HERE.

  fsubw = 1.0 + 1.0e-8 * p(i) * ( 4.5 +                                       &
    6.0e-4 * ( t(i) - zerodegc ) * ( t(i) - zerodegc ) )

  !      USE THE LOOKUP TABLE TO FIND SATURATED VAPOUR PRESSURE, AND STORE
  !      IT IN QS.

  tt = MAX(t_low,t(i))
  tt = MIN(t_high,tt)

  atable = (tt - t_low + delta_t) / delta_t
  itable = atable
  atable = atable - itable

  qs(i) = (1.0 - atable) * es(itable) + atable * es(itable+1)

  !      MULTIPLY BY FSUBW TO CONVERT TO SATURATED VAPOUR PRESSURE IN AIR
  !      (EQUATION A4.6 OF ADRIAN GILL'S BOOK).

  qs(i) = qs(i) * fsubw

  !      NOW FORM THE ACCURATE EXPRESSION FOR QS, WHICH IS A REARRANGED
  !      VERSION OF EQUATION A4.3 OF GILL'S BOOK.

  !      NOTE THAT AT VERY LOW PRESSURES WE APPLY A FIX, TO PREVENT A
  !      SINGULARITY (Qsat tends to 1. kg/kg).

  qs(i) = ( repsilon * qs(i) ) /                                              &
          ( MAX(p(i),qs(i)) - one_minus_epsilon * qs(i) )

END DO ! Npnts_do_1

RETURN
END SUBROUTINE qsat_wat
! ======================================================================
#endif
